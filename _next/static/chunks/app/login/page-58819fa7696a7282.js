(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[520],{68:e=>{e.exports={container:"login_container__kitvQ",loginBox:"login_loginBox___U_z1",logo:"login_logo__uuWzc",title:"login_title__r1aBc",formGroup:"login_formGroup__exBI3",label:"login_label__9OzGh",input:"login_input__GK8Qo",button:"login_button__dh0qR",error:"login_error__wxSLK",link:"login_link__sOeCn"}},278:(e,t,r)=>{Promise.resolve().then(r.bind(r,9690))},3405:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var o=r(5155),l=r(7600),a=r(5695),n=r(2115);function s(e){let{children:t}=e,{user:r,loading:s}=(0,l.A)(),i=(0,a.useRouter)();return((0,n.useEffect)(()=>{!s&&r&&i.push("/profile")},[r,s]),s)?null:(0,o.jsx)(o.Fragment,{children:!r&&t})}},7600:(e,t,r)=>{"use strict";r.d(t,{A:()=>i,AuthProvider:()=>s});var o=r(5155),l=r(8840),a=r(2115);let n=(0,a.createContext)(void 0);function s(e){let{children:t}=e,[r,s]=(0,a.useState)(null),[i,c]=(0,a.useState)(!0);return(0,a.useEffect)(()=>{let e=localStorage.getItem("user"),t=localStorage.getItem("token");if(t&&e)try{(0,l.H)(t)?localStorage.clear():s(JSON.parse(e))}catch(e){localStorage.clear()}c(!1)},[]),(0,o.jsx)(n.Provider,{value:{user:r,setUser:s,logout:()=>{localStorage.clear(),s(null)},loading:i},children:t})}function i(){let e=(0,a.useContext)(n);if(!e)throw Error("useAuth must be used within AuthProvider");return e}},8840:(e,t,r)=>{"use strict";function o(e){try{let t=JSON.parse(atob(e.split(".")[1])),r=1e3*t.exp;return Date.now()>=r}catch(e){return!0}}function l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12e4;try{let r=JSON.parse(atob(e.split(".")[1])),o=1e3*r.exp,l=Date.now();return o-l<t}catch(e){return!0}}r.d(t,{H:()=>o,n:()=>l})},9690:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>p});var o=r(5155),l=r(3405),a=r(7600),n=r(6766),s=r(6874),i=r.n(s),c=r(5695),u=r(2115),g=r(3568),h=r(68),d=r.n(h);function p(){let e=(0,c.useRouter)(),[t,r]=(0,u.useState)("brunoscosta17@gmail.com"),[s,h]=(0,u.useState)("123456"),[p,_]=(0,u.useState)(""),{setUser:m}=(0,a.A)(),f=async r=>{r.preventDefault(),_("");try{let r=fetch("https://localhost:7026/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t,password:s})});g.Ay.promise(r,{loading:"Logging in...",error:"Login failed. Please try again."});let o=await r,l=await o.json();if(!o.ok)return void _(l.message||"Login failed.");localStorage.setItem("token",l.token),localStorage.setItem("user",JSON.stringify(l.user)),localStorage.setItem("refreshToken",l.refreshToken),m(l.user),e.push("/profile"),g.Ay.success("Welcome, ".concat(l.user.name,"!"))}catch(e){console.error(e),g.Ay.error("Login failed."),_("Network error.")}};return(0,o.jsx)(l.A,{children:(0,o.jsx)("div",{className:d().container,children:(0,o.jsxs)("form",{className:d().loginBox,onSubmit:f,children:[(0,o.jsx)(n.default,{src:"/react-logo.png",alt:"React logo",width:80,height:80,className:d().logo}),(0,o.jsx)("h2",{className:d().title,children:"Login"}),(0,o.jsxs)("div",{className:d().formGroup,children:[(0,o.jsx)("label",{className:d().label,children:"Email"}),(0,o.jsx)("input",{className:d().input,type:"email",required:!0,value:t,onChange:e=>r(e.target.value)})]}),(0,o.jsxs)("div",{className:d().formGroup,children:[(0,o.jsx)("label",{className:d().label,children:"Password"}),(0,o.jsx)("input",{className:d().input,type:"password",required:!0,value:s,onChange:e=>h(e.target.value)})]}),(0,o.jsx)("button",{className:d().button,type:"submit",children:"Login"}),p&&(0,o.jsx)("p",{className:d().error,children:p}),(0,o.jsxs)("p",{className:d().link,children:["Donâ€™t have an account? ",(0,o.jsx)(i(),{href:"/register",children:"Create one"})]})]})})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[471,568,244,766,441,684,358],()=>t(278)),_N_E=e.O()}]);