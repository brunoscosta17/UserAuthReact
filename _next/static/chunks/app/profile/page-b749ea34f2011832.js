(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[636],{2030:(e,t,a)=>{Promise.resolve().then(a.bind(a,3691))},3691:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>c});var o=a(5155),r=a(8840);async function l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=localStorage.getItem("token"),o=localStorage.getItem("refreshToken"),l=localStorage.getItem("user"),n=l?JSON.parse(l).email:null;if(a&&o&&n&&(0,r.n)(a)){let e=await fetch("https://localhost:7026/api/auth/refresh-token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n,refreshToken:o})});if(e.ok){let t=await e.json();a=t.token,localStorage.setItem("token",t.token),localStorage.setItem("refreshToken",t.refreshToken)}else throw localStorage.clear(),Error("Session expired. Please log in again.")}let s={...t.headers||{},Authorization:a?"Bearer ".concat(a):"","Content-Type":"application/json"};return fetch(e,{...t,headers:s})}var n=a(2115),s=a(7687),i=a.n(s);function c(){let[e,t]=(0,n.useState)(null);return((0,n.useEffect)(()=>{(async()=>{try{let e=await l("https://localhost:7026/api/profile/me");if(!e.ok)throw Error();let a=await e.json();t(a)}catch(e){console.error("Invalid session.",e),localStorage.clear(),window.location.href="/UserAuthReact/login"}})()},[]),e)?(0,o.jsx)("div",{className:i().container,children:(0,o.jsxs)("div",{className:i().box,children:[(0,o.jsxs)("h2",{className:i().title,children:["Welcome, ",e.name,"!"]}),(0,o.jsxs)("p",{className:i().paragraph,children:[(0,o.jsx)("strong",{children:"Email:"})," ",e.email]})]})}):null}},7687:e=>{e.exports={container:"profile_container__CYebx",box:"profile_box__Ny0ES",title:"profile_title__Qm44E",paragraph:"profile_paragraph__HQq4n",logout:"profile_logout__Ciu6g"}},8840:(e,t,a)=>{"use strict";function o(e){try{let t=JSON.parse(atob(e.split(".")[1])),a=1e3*t.exp;return Date.now()>=a}catch(e){return!0}}function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12e4;try{let a=JSON.parse(atob(e.split(".")[1])),o=1e3*a.exp,r=Date.now();return o-r<t}catch(e){return!0}}a.d(t,{H:()=>o,n:()=>r})}},e=>{var t=t=>e(e.s=t);e.O(0,[119,441,684,358],()=>t(2030)),_N_E=e.O()}]);